exit
sorted_last_seen
continue
    sorted_last_seen
 sorted_activity 
continue
sites.select { |entry| entry["activated"] == 1 }
sites.select { |entry| entry[:activated] == 1 }
sites
continue
sites
exit
sites.select { |entry| entry[:activated] == 1 }
sites.select { |entry| entry["activated"] == 1 }
sites
continue
total_sites
continue
sites
exit
sites
total_sites
continue
total_sites
exit
continueall
continue
site['district_name']
continue
site['days_since_last_seen'].to_i > 3
site['days_since_last_activity'].to_i > 3  && site['days_since_last_seen'].to_i < 3
site['district_name']
site['district_id']
continue
exit
sites.each 
sites.is_a?(Array)
 sites.select { |entry| entry["activated"] == 1 }
sites
continue
exit
sites
continue
 calculate_stats(yesterday_sites)
yesterday_sites.is_a?(Array)
 yesterday_sites.is_a?(Hash) && yesterday_sites[:last_seen] && yesterday_sites[:last_seen][:districts]
 yesterday_sites
exit
yesterday_data
 yesterday_seen 
exit
 yesterday_data
  yesterday_seen
continue
exit
yesterday_data
exit
yesterday_data
yesterday_data.last
yesterday_data.first
yesterday_data.first["last_seen"]
yesterday_data.first["district_id"]
yesterday_data.first[:district_id]
yesterday_data.first
yesterday_data
yesterday_data["0"]["last_seen"]
yesterday_data[0]["last_seen"]
yesterday_data[0][:last_seen]
yesterday_data
yesterday_data["last_seen"]
yesterday_data[:last_seen]
yesterday_data = JSON.parse(yesterday_cache.value)
 yesterday_cache.value[:last_seen]
 yesterday_cache.value
 yesterday_cache 
 yesterday_data
 yesterday_data["last_seen"]
 yesterday_data[:last_seen]
 yesterday_data[:last_seen][:districts].index_by { |d| d[:district_id] } 
yesterday_data[:last_seen][:districts].index_by { |d| district_id(d) }
yesterday_data = yesterday_data.to_json
yesterday_data.to_json
yesterday_data[:last_seen][:districts].index_by { |d| district_id(d) }
yesterday_data = yesterday_cache.value
yesterday_cache.value
yesterday_cache
yesterday_cache.to_array
yesterday_cache.to_a
 yesterday_data[:last_seen][:districts].index_by { |d| district_id(d) }
 yesterday_data = yesterday_cache.to_json
yesterday_cache.to_json
yesterday_cache
yesterday_cache[:last_seen][:districts].index_by { |d| district_id(d) }
yesterday_cache
exit
puts "YESTERDAY DISTRICTS: #{yesterday_data[:last_seen][:districts].inspect}"
exit
 yesterday_data[:last_seen][:districts].index_by { |d| d[:district_id] } 
today_stats[:last_seen][:districts].index_by { |d| d[:district_id] }
yesterday_data[:last_seen][:districts].index_by { |d| d[:district_id] } 
yesterday_data[:last_seen][:districts].index_by { |d| d[:district_id] }
 yesterday_data
 yesterday_data[
   yesterday_seen
exit
yesterday_districts
  def self.add_comparison_to_districts(today_districts, yesterday_districts, key)
      yest_d = yesterday_districts[district[:district_id]]
district[:district_id]
district
yesterday_districts[district[:district_id]]
yest_count
today_count
continue
conitnue
 stat = SyncStatsCache.where(name: 'last_seen_and_last_sync', created_at: range).order(created_at: :desc).first
Time.zone.today.beginning_of_day
Time.zone.today.end_of_day
continue
last_seen
exit
last_seen
continue
exit
result[:comparison]
result[:last_seen][:comparison]
exit
 @last_seen_data
 @last_seen_data[:comparison] 
continue
result
exit
districts
sync_errors
exit
districts.each do |id, info|  puts "#{info[:name]} (#{info[:sites_with_errors]} out of #{info[:total_sites] sites)" end
districts.each do |id, info|
  puts "#{info[:name]} (#{info[:sites_with_errors]} out of #{info[:total_sites]} sites)"
end
exit
sync_errrors
districts
sync_errors
continue
 sync_errors 
continue
request.headers[:Authorization]
request.headers
exit
request.headers
request.headers[:Authorization]
exit
result
exit
 base_url
exit
request.host
continue
 LowNpidNotificationMailer.low_npid_summary(result).deliver_later
result[:districts].present?
result[:districts].any?
result[:districts].any
result[:districts]
continue
result[:total_sites]
exit
result[:total_sites]
result[:last_seen]
result[:last_activity][:districts].any?
result[:last_activity]
result[:last_activity
continue
html
exit
sites.count
sorted_districts
  sorted_districts 
exit
Rails.application.routes.default_url_options[:host]
host
continue
html
continue
 @admin_list
  @mailing_list
continue
@last_seen_data
exit
@last_seen_data
last_seen_data
continue
exit
 LastSeenMailer.summary_of_last_seen(result[:last_seen][:districts]).deliver_now 
exit
 LastSeenMailer.summary_of_last_seen(result[:last_seen][:districts]).deliver_now 
exit
 LastSeenMailer.summary_of_last_seen(result[:last_seen][:districts]).deliver_now 
exit
 LastSeenMailer.summary_of_last_seen(result[:last_seen][:districts]).deliver_now 
exit
 LastSeenMailer.summary_of_last_seen(result[:last_seen][:districts]).deliver_now 
exit
 LastSeenMailer.summary_of_last_seen(result[:last_seen][:districts]).deliver_now 
exit
 LastSeenMailer.summary_of_last_seen(result[:last_seen][:districts]).deliver_now 
exit
result[:last_seen][:districts][2]
result[:last_seen][:districts][0]
result[:last_activity][:districts][0]
result[:last_seen][:districts][0]
exit
result[:last_seen][:districts][0]
result[:last_seen][:districts]
LastSeenMailer.summary_of_last_seen(result[:last_seen][:districts]).deliver_now
result[:last_seen][:total_sites_with_issue]
result[:last_seen][:total_last_seen_sites]
result[:last_seen][:districts]
result[:last_seen]
exit
ApplicationController.render(  template: 'mailing_lists/index',  assigns: { district_data: @district_data })
ApplicationController.render(  template: 'last_seen_mailer/report',  assigns: { district_data: @district_data })
html
exit
html_content
exit
 html_content
exit
renderer.render( template: 'last_seen_mailer/report', locals: { district_data: @district_data })
renderer = ApplicationController.renderer.new(
  http_host: 'example.org',
  https: Rails.env.production?
)
Rails.env.production?
request.host
ApplicationController.renderer.render( template: 'last_seen_mailer/report', locals: { district_data: @district_data })
exit
ApplicationController.renderer.render( partial: 'last_seen_mailer/last_seen_more_than_3_days.html', locals: { district_data: @district_data })
ApplicationController.renderer.render( partial: "last_seen_mailer/report.html")
ApplicationController.renderer.render( partial: "last_seen_mailer/report")
ApplicationController.renderer.render( partial: 'last_seen_mailer/report')
ApplicationController.renderer.render( partial: 'last_seen_mailer/report', locals: { district_data: @district_data })
 ApplicationController.renderer.render( partial: 'last_seen_mailer/report', locals: { district_data: @district_data }
 html_content
exit
"#{Rails.root}/app/views/last_seen_mailer/report"
#{Rails.root}/app/views/last_seen_mailer/report
 html_content
exit
 html_content
exit
sites
    grouped_sites
continue
continue 
exit
 @district_data
